# Cookie & Session📌

### HTTP 프로토콜 특징
* Connectionless(비연결지향)
  > HTTP 프로토콜은 클라이언트에서 서버에 요청을 보내면 서버는 클라이언트에 응답을 하고 연결을 끊는 특징을 가지고 있음.
  * HTTP 1.1버전에서 Connection 헤더에 Keep-alive라고 설정하면 커넥션을 유지하고, 요청에 재활용하는 기능이 추가 됨
    HTTP 1.1 버전에서는 기본 옵션이다.
* Stateless(상태 정보 유지 안함)
  > HTTP 통신은 연결을 끊는 순간 클라이언트와 서버의 통신이 끝나며 상태 정보를 유지하지 않는 특징이 있다.
  * 클라이언트와 첫번째 통신에서 데이터를 주고받았다 해도, 두 번쨰 통신에서 이전 데이터를 유지하지 않는다.   
    하지만 실제로는 데이터 유지가 필요한 경우가 많다.

### 쿠키와 세션을 사용하는 이유
> 쿠키와 세션은 HTTP 프로토콜의 특징이자 약점을 보완하기 위해 사용함.
* HTTP 프로토콜의 특징인 비연결지향과 상태정보 유지 안함으로 인해 매번 페이지를 이동할 때 마다 로그인을 다시 해야하거나
  상품 선택 후 구매 페이지에서 선택한 상품의 정보가 없거나 하는 등의 문제가 발생할 수 있는데,
  이러한 어려움과 불편함을 해결하기 위한 것이 쿠키와 세션임

### 쿠키
> HTTP의 일종으로 사용자가 어떤 웹 사이트를 방문할 경우, 해당 사이트가 사용하고 있는 서버에서 **사용자의 컴퓨터에** 저장하는 작은 기록 정보 파일.        
> HTTP에서 클라이언트의 상태 정보를 쿠키 형태로 클라이언트 PC에 저장하였다가 필요시 정보를 참조하거나 **재사용** 가능
* **쿠키의 특징**
  * Key-Value쌍으로 구성되어있는 데이터 파일
  * 쿠키 이름, 쿠키 값, 만료시간, 전송할 도메인명, 전송할 경로, 보안연결 여부, HttpOnly여부로 구성되어 있음
  * 도메인 당 20개의 쿠키를 가질 수 있음
  * 하나의 쿠키는 4KB(4096byte)까지 저장이 가능함.

<br>

* **쿠키의 작동 방식**
  1. 클라이언트가 서버에 로그인 요청
  2. 서버는 클라이언트의 로그인 요청의 유효성 확인 후 응답 헤더에 set-cookie를 통해 쿠키를 추가하여 응답
  3. 클라이언트는 이후 서버에 요청할 때 전달 받은 쿠키를 자동으로 요청헤더에 추가하여 요청.      
     -> 헤더에 쿠기값을 자동으로 추가하여 주는데 이는 브라우저에서 처리해주는 작업임
  *만일 쿠키의 기한이 정해져 있지 않고 명시적으로 지우지 않는다면 반 영구적으로 쿠키가 남아있음*

<br>

* **쿠키의 사용목적**
  * 세션 관리
    * 로그인, 사용자 닉네임, 접속시간, 장바구니 등의 서버가 알아야할 정보들을 저장
  * 개인화
    * 사용자마다 다르게 그 사람에 적절한 페이지를 보여줄 수 있다.
  * 트래킹
    * 사용자의 행동과 패턴을 분석하고 기록

<br>

* **쿠키의 종류**
  * Session Cookie
    > 일반적으로 만료시간을 설정하고 메모리에만 저장되며, 브라우저 종료 시 쿠키 삭제
  * Persistent Cookie
    > 장기간 유지되는 쿠키이다. 파일로 저장되어 브라우저 종료와 관계없이 사용할 수 있다.
  * Secure Cookie
    > HTTPS 프로토콜에서만 사용하며, 쿠키 정보가 암호화되어 전송된다.
  * Third-Party Cookie
    > 방문한 도메인과 다른 도메인의 쿠기. 일반적으로 광고 배너 등을 관리할 때 유입 경로를 추적하기 위해 사용

<br>

* 쿠키값 확인 및 단점
> 브라우저 개발자도구의 네트워크에서 쿠키값을 확인할 수 있지만, 가독성이 떨어지고 수정이 불가능함.
> 하지만 '브라우저 쿠키 관리 탭' 또는 '쿠키 관리 플러그인'을 설치하면 쿠키를 쉽게 수정할 수 있음
