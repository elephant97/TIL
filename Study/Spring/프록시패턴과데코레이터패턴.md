# Proxy Patten / Decorator Pattern
김영한님 Spring 핵심원리 - 고급편

<br>

### 프록시란?
* 클라이언트(요청자)가 서버(처리자)에게 요청을 보낼 떄 직접 서버로 보내는 것이 아닌 대리자(Proxy)를 통해 요청을 보내는 것
* 클라이언트는 프록시를 통해 요청하기 때문에 이후 과정은 모르며, 심지어는 서버에게 요청한 것인지 프록시에게 요청한 것인지도 모른다
* 클라이언트가 사용하는 서버 객체를 프록시 객체로 변경해도 클라리언트 코드를 변경하지 않고 동작할 수 있어야 한다
* 서버와 프록시가 같은 인터페이스를 사용해야하며, 클라이언트는 서버 인터페이스에만 의존해야한다.
* 따라서 DI를 이용하여 클라이언트의 변경없이 대체가 유연하게 가능하다.

### 프록시의 주요기능
* 프록시를 통해서 할 수 있는 일은 크게 2가지로 구분 가능
  * 접근제어
    * 권한에 따른 접근 차단
    * 캐싱
    * 지연 로딩
  * 부가 기능 추가
    * 원래 서버가 제공하는 기능에 더해서 부가 기능을 수행한다.
    * 에) 요청 값이나, 응답 값을 중간에 변형한다
    * 예) 실행 시간을 측정해서 추가 로그를 남긴다
  * 프록시 객체가 중간에 있으면 크게 접근 제어와 부가 기능을 수행할 수 있다.

### GOF 디자인 패턴
> 둘다 프록시를 사용하는 방법이지만, GOF디자인 패턴에서는 이 둘을 의도에 따라 프록시 패턴과 데코레이터 패턴으로 구분함.
  * 프록시 패턴
    * 접근 제어가 목적
  * 데코레이터 패턴
    * 새로운 기능 추가가 목적
* 둘다 프록시를 사용하지만, 의도가 다르다는 점이 핵심
* 용어가 프록시 패턴이라고 해서 프록시 패턴만 프록시를 사용하는 것이 아닌 데코레이터도 프록시 패턴을 사용한다. 
* *프록시라는 개념은 클라이언트 서버라는 큰 개념 안에서 자연스럽게 발생할 수 있다.*      
  *프록시는 객체 안에서의 개념도 있고, 웹 서버에서의 프록시도 있다.*      
  *객체 안에서 객체로 구현되어있는가, 웹 서버로 구현되어 있는가 처럼 규모의 차이가 있을 뿐 근본적인 역할은 같다.* 

### 인터페이스 기반 프록시 vs 클래스 기반 프록시
* 인터페이스가 없어도 클래스 기반으로 프록시를 생성할 수 있다.
* 클래스 기반 프록시는 해당 클래스에만 적용할 수 있다.
* 인터페이스 기반 프록시는 인터페이스만 같으면 모든 곳 에 적용할 수 있다.
* **인터페이스 기반 프록시**는 캐스팅 관련하여 단점이 있다.
* **클래스 기반 프록시**는 상속을 사용하기 때문에 몇가지 제약이 있다.
  * 부모 클래스의 생성자를 호출해야 한다.(앞서 본 예제)
  * 클래스에 final 키워드가 붙으면 상속이 불가능하다.
  * 메서드에 final 키워드가 붙으면 해당 메서드를 오버라이딩 할 수 없다.
