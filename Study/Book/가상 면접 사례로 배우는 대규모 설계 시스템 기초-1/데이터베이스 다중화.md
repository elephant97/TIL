# 데이터베이스 다중화

<aside>
💡 보통 서버 사이에 주(master)-부(slave) 관계를 설정하고 데이터 원본은 주 서버에 사본은 부 서버에 
저장하는 방식

</aside>

- 쓰기 연산은 마스터에서만 지원하며, 부 데이터베이스는 주 데이터베이스로부터 그 사본을 받으며 읽기 연산 만을 지원
- 데이터베이스를 변경하는 명령어들(insert, delete, update 등)은 주 데이터베이스로만 전달되어야 함
- 대부분의 애플리케이션은 읽기 연산의 비중이 쓰기 연산보다 훨씬 높음
- 따라서 부 데이터베이스 수보다 주 데이터베이스의 수보다 많음

- **데이터베이스를 다중화 하면 어떤 이득이 있을까?**
    - 더 나은 성능
        - 주-부 다중화 모델에서 모든 데이터 변경 연산은 주 데이터베이스 서버로만 전달되는 반면,
        읽기 연산은 부 데이터베이스 서버들로 분산됨
        - 병렬로 처리될 수 있는 질의(query)의 수가 늘어나므로 성능이 좋아짐
    - 안정성(reliability)
        - 자연 재해 등의 이유로 데이터베이스 서버 가운데 일부가 파괴되어도 데이터는 보존될 수 있음
        - 데이터를 지역적으로 떨어진 여러 장소에 다중화시켜 놓을 수 있기 때문
    - 가용성(availibility)
        - 데이터를 여러 지역에 복제해 둠으로써, 하나의 데이터베이스 서버에 장애가 발생하더라도
        다른 서버에 있는 데이터를 가져와 계속 서비스 할 수 있게 됨
        
- 데이터베이스가 다중화 되어있는 상태에서 하나의 서버가 다운 되면 어떤 일이 벌어질까?
    - 부 서버가 다운되는 경우
        - 부 서버가 한 대 뿐인 경우
            - 읽기 연산은 한시적으로 모두 주 데이터베이스로 전달됨
            - 즉시 새로운 부 데이터베이스 서버가 장애 서버를 대체하게 됨
        - 부 서버가 여러 대인 경우
            - 읽기 연산은 나머지 부 데이터베이스 서버들로 분산됨
            - 새로운 부 데이터베이스 서버가 장애 서버를 대체하게 됨
    - 주 서버가 다운되는 경우
        - 부 서버가 한 대 뿐인 경우
            - 부 데이터베이스 서버가 새로운 주 서버가 됨
            - 모든 데이터베이스 연산은 일시적으로 새로운 주 서버상에서 수행됨
            - 또한 새로운 부 서버가 추가되게 됨
                - 부 서버에 보관된 데이터가 최신 상태가 아니라면?
                    - 없는 데이터는 복구 스크립트를 돌려서 추가해야함
                    - 다중 마스터나 원형 다중화 방식을 도입하면 이런 사항에 대처할 순 있으나, 구성이 매우 복잡하다는 단점이 있다.
